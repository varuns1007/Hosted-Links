let user=[],discounts=[],cartData=[],shopDomain=Shopify.shop.split(".")[0],shopifyThemeId=Shopify.theme.theme_store_id,shopifyCurrency=Shopify.currency.active,frontendUrl="https://discounts.superassistant.io",hostedUrl="https://2b65649b967a.ngrok.io";function startTieredPricing(){function t(){function t(t,e){a=t,console.log(e),e.classList.remove("clicked"),"Above"===a?e.insertAdjacentHTML("beforebegin","<div style=\"display:block;border: 1px solid grey;padding: 1em;background-color: #dff0d8;width: fit-content;\" id=\"superAssistant147963851\"><p>Widget will be displayed here</p></div>"):"Below"===a&&e.insertAdjacentHTML("afterend","<div style=\"display:block;border: 1px solid grey;margin:0.5em 0;padding: 1em;background-color: #dff0d8;width: fit-content;\"id=\"superAssistant147963851\"><p>Widget will be displayed here</p></div>"),document.querySelector("#ulList").style.display="none",console.log(e.classList[0]),console.log(e.tagName.toLowerCase()),l.style.display="block",c.disabled=!1,c.style.background="#9c6ade",c.addEventListener("click",()=>{let t=[],i=[];if(console.log(e.attributes),0<e.attributes.length)for(let a=0;a<e.attributes.length;a++)"class"===e.attributes[a].name?t=e.attributes[a].value.split(" "):i.push(e.attributes[a].name);console.log(t),console.log(a),axios.post(`${hostedUrl}/widgetSave`,{className:t,tagName:e.tagName.toLowerCase(),location:a,shopDomain:shopDomain,attributes:i}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),s.addEventListener("click",()=>{c.style.background="#bac0e6",c.disabled=!0,o=!1;let t=document.querySelector("#superAssistant147963851");t&&t.parentNode.removeChild(t)})}function e(t){t.shiftKey&&!o?(document.body.classList.add("shift-pressed"),l.style.display="none"):document.body.classList.remove("shift-pressed")}let a,i;var o=!1;let l=document.createElement("div");l.style.width="fit-content",l.style.padding="1em",l.style.position="absolute",l.style.left="0",l.style.right="0",l.style.marginLeft="auto",l.style.marginRight="auto",l.style.top="3%",l.style.zIndex="99999",l.style.background="#f4f6f8",l.style.border="1px solid #bec0c2",l.style.borderRadius="4px";let n=document.createElement("p");n.innerText="Select location for Tiered pricing while holding the Shift key.";let d=document.createElement("div");d.style.textAlign="right";let c=document.createElement("button");c.innerText="Save",c.style.marginLeft="0.7em",c.style.background="#bac0e6",c.style.color="white",c.style.border="1px solid grey",c.style.borderRadius="4px",c.disabled=!0;let s=document.createElement("button");s.innerText="Clear",s.style.border="1px solid grey",s.style.borderRadius="4px",d.appendChild(s),d.appendChild(c),l.appendChild(n),l.appendChild(d),document.querySelector("body").appendChild(l);var r=document.querySelector("button");r.addEventListener("mousemove",e),window.addEventListener("keydown",e),window.addEventListener("keyup",e),window.addEventListener("click",function(e){e.shiftKey&&(o=!0,e.target.classList.add("clicked"),i=e.target,e.target.insertAdjacentHTML("afterend","<div class=\"positionPopup\" id=\"ulList\"><ul><li id=\"Above\"><a href=\"#\">Above Element</a> </li><li id=\"Below\"><a href=\"#\">Below Element</a> </li></ul></div>"),document.querySelector("#Above").addEventListener("click",()=>t("Above",i)),document.querySelector("#Below").addEventListener("click",()=>t("Below",i)),document.body.className="")})}function e(){let t=async function(){let t=await fetch("/cart.js");return t=await t.json(),t}();t.then(t=>{function e(t,e){let a={applicableDiscount:0,discountType:""};return discounts.forEach(o=>{if(o.enable&&-1!==o.productIds.indexOf(e))for(let e=0;e<o.priceRule.length;e++)o.priceRule[e].quantity===t&&(a.applicableDiscount=o.priceRule[e].discount,a.discountType=o.priceRule[e].discountType)}),a}function a(t,e){let a={applicableDiscount:0,XproductId:0,XproductName:"",YproductId:[],YproductName:[]};return discounts.forEach(o=>{if(o.enable&&-1!==o.productIds.indexOf(e))for(let l=0;l<o.buyXgetY.length;l++)o.buyXgetY[l].quantity===t&&(a.applicableDiscount=o.buyXgetY[l].yDiscountValue,a.XproductId=e,o.buyXgetY[l].yProduct.forEach(t=>{a.YproductId.push(t.id),a.YproductName.push(t.title)}),d.items.forEach(t=>{if(t.variant_id===e)return void(a.XproductName=t.title)}))}),a}function i(t){let e=[];for(let a=0;a<t.length;a++)e.push(`[${t[a]}]`);return e.join("")}function o(t){let e=[];for(let a=0;a<t.length;a++)e.push(`.${t[a]}`);return e.join("")}function l(t,e){return`You are eligible for a discount of ${t}% off on ${e}`}function n(){function t(t){var e=t.target.id.split("_");let a=e[e.length-1].split(":")[0];for(let e=0;e<g.length;e++)g[e].productId===a&&(g[e].originalProductQuantity=t.target.value);console.log(g),m.observe(y,h)}if(c=document.querySelectorAll("form[action^=\"/cart\"] [type=\"submit\"]"),c=796===shopifyThemeId?c[0]:766===shopifyThemeId?c[0]:c[1],s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"number\"]"),0===s.length&&(s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"text\"]")),""!==user.individualProductLocation.tagName)if(0!==user.individualProductLocation.attribute.length&&0!==user.individualProductLocation.className.length){let t=i(user.individualProductLocation.attribute),e=o(user.individualProductLocation.className);r=document.querySelectorAll(`${user.individualProductLocation.tagName}${t}${e}`)}else if(0===user.individualProductLocation.attribute.length){let t=o(user.individualProductLocation.className);r=document.querySelectorAll(`${user.individualProductLocation.tagName}${t}`)}else if(0===user.individualProductLocation.className.length){let t=i(user.individualProductLocation.attribute);r=document.querySelectorAll(`${user.individualProductLocation.tagName}${t}`)}if(""!==user.productTotalLocation.tagName)if(0!==user.productTotalLocation.attribute.length&&0!==user.productTotalLocation.className.length){let t=i(user.productTotalLocation.attribute),e=o(user.productTotalLocation.className);u=document.querySelectorAll(`${user.productTotalLocation.tagName}${t}${e}`)}else if(0===user.productTotalLocation.attribute.length){let t=o(user.productTotalLocation.className);u=document.querySelectorAll(`${user.productTotalLocation.tagName}${t}`)}else if(0===user.productTotalLocation.className.length){let t=i(user.productTotalLocation.attribute);u=document.querySelectorAll(`${user.productTotalLocation.tagName}${t}`)}if(r.length>d.items.length){console.log(r);let t=Array.prototype.slice.call(r,0);0!=t.length%2&&t.pop(),console.log(t),r=[],u=[];for(let e=0;e<t.length;e++)0==e%2?r.push(t[e]):u.push(t[e])}console.log("individual"+r),console.log("total"+u),m.disconnect(),console.log(g);let n=0,b=0,L=[],f=[],x=[];g.forEach(t=>{let i=parseInt(t.originalProductQuantity)*parseInt(t.price);n+=i;let o=e(parseInt(t.originalProductQuantity),parseInt(t.productId));console.log(o);let l;if("%"===o.discountType){l=o.applicableDiscount;let e=l/100*parseInt(t.price),a=parseInt(t.price)-e;L.push(a),console.log(a*parseInt(t.originalProductQuantity));let i=a*parseInt(t.originalProductQuantity);f.push(i),0!==l&&(b+=e*parseInt(t.originalProductQuantity))}else{l=o.applicableDiscount,l*=parseInt(t.originalProductQuantity),console.log(l);let e=(i-parseInt(l))/t.originalProductQuantity;L.push(e);let a=i-parseInt(l);f.push(a),"0"!==l&&(b+=l)}let d=a(parseInt(t.originalProductQuantity),parseInt(t.productId));0!==d.applicableDiscount&&x.push(d)});let j=user.Customtemplate.template;console.log(j),console.log(n,b),console.log(L),console.log(f);let v=n-b;if(console.log(v),console.log("heyy"),user.Customtemplate.showCustomTemplate&&user.Customtemplate.location.subtotalPrice){let t=Math.round(n-v)+"",e=j.search(":diff"),a=j.split("");console.log(a),a.splice(e,5,`${shopifyCurrency}.${t}`),console.log(a.join("")),y&&(v===n?y.innerHTML=`<ins style="text-decoration:none">${shopifyCurrency}. ${n+""}.00</ins>`:y.innerHTML=`<del style="font-size:0.8em;font-weight:600;color:grey">${shopifyCurrency}. ${Math.round(n)+""}.00</del><br> <ins style="text-decoration:none">${shopifyCurrency}. ${Math.round(v)+""}.00</ins><br><span style="color:#ef5e64;font-weight:600">${a.join("")}</span>`)}if(user.Customtemplate.showCustomTemplate&&user.Customtemplate.location.individualPrice)for(let t=0;t<L.length;t++){let e=parseInt(g[t].price)-Math.round(L[t])+"",a=j.search(":diff"),i=j.split("");console.log(i),i.splice(a,5,`${shopifyCurrency}.${e}`),console.log(i.join("")),g[t].priceDiv&&L[t]!==parseInt(g[t].price)&&(g[t].priceDiv.innerHTML=`<del style="font-size:0.8em;font-weight:600;color:grey">${shopifyCurrency}. ${g[t].price}.00</del> <br><ins style="text-decoration:none">${shopifyCurrency}. ${Math.round(L[t])+""}.00</ins><br><span style="color:#ef5e64;font-weight:600">${i.join("")}</span>
              `)}if(user.Customtemplate.showCustomTemplate&&user.Customtemplate.location.totalPrice)for(let t,e=0;e<f.length;e++){t=parseInt(g[e].originalProductQuantity)*parseInt(g[e].price),console.log(g[e].originalProductQuantity,g[e].price),console.log(f[e]);let a=t-Math.round(f[e])+"",i=j.search(":diff"),o=j.split("");console.log(o),o.splice(i,5,`${shopifyCurrency}.${a}`),console.log(o.join("")),g[e].totalPriceDiv&&f[e]!==t&&(g[e].totalPriceDiv.innerHTML=`<del style="font-size:0.8em;font-weight:600;color:grey">${shopifyCurrency}. ${t+""}.00</del><br> <ins style="text-decoration:none">${shopifyCurrency}. ${Math.round(f[e])+""}.00</ins><br><span style="color:#ef5e64;font-weight:600">${o.join("")}</span>`)}let S=document.createElement("div");S.style.width="fit-content",S.style.padding="1em",S.style.position="absolute",S.style.left="0",S.style.right="0",S.style.marginLeft="auto",S.style.marginRight="auto",S.style.top="3%",S.style.zIndex="99999",S.style.background="#f4f6f8",S.style.border="1px solid #bec0c2",S.style.borderRadius="4px";let _=document.createElement("p"),p=document.createElement("div");p.style.textAlign="right";let T=document.createElement("button");T.innerText="OK",T.style.background="#337CA0",T.style.padding="0.2em 1em",T.style.color="white",T.style.border="1px solid grey",T.style.borderRadius="14px",T.style.float="right",T.onclick=()=>{S.style.display="none"},p.appendChild(T),S.appendChild(_),S.appendChild(p),S.style.display="none",document.querySelector("body").appendChild(S);let N=[];console.log(x);let A=[];d.items.forEach(t=>{N.push(t.variant_id)}),console.log(N);for(let t=0;t<x.length;t++){console.log(-1===N.indexOf(x[t].XproductId)),console.log(l(x[t].applicableDiscount,x[t].YproductName));for(let e=0;e<x[t].YproductId.length;e++)-1===N.indexOf(x[t].YproductId[e])&&A.push(l(x[t].applicableDiscount,x[t].YproductName[e]))}console.log(A),0<A.length&&(_.innerText=A.join("\n")+"\nKindly add the products in cart to avail the discount.",S.style.display="block"),s.forEach(e=>{e.addEventListener("input",t)}),console.log("event listeners set")}let d=t;console.log(d);var c,s,r=[],u=[];let g=[];console.log(a(1,39414727180486)),console.log(a(1,39414728392902)),console.log(e(2,39414728392902)),console.log(e(3,39414727180486)),console.log(user);var y;if(""!==user.cartSubTotalLocation.tagName)if(0!==user.cartSubTotalLocation.attribute.length&&0!==user.cartSubTotalLocation.className.length){let t=i(user.cartSubTotalLocation.attribute),e=o(user.cartSubTotalLocation.className);y=document.querySelector(`${user.cartSubTotalLocation.tagName}${t}${e}`)}else if(0===user.cartSubTotalLocation.attribute.length){let t=o(user.cartSubTotalLocation.className);y=document.querySelector(`${user.cartSubTotalLocation.tagName}${t}`)}else if(0===user.cartSubTotalLocation.className.length){let t=i(user.cartSubTotalLocation.attribute);y=document.querySelector(`${user.cartSubTotalLocation.tagName}${t}`)}console.log(y);const h={attributes:!0,childList:!0,subtree:!0};console.log("reached");const m=new MutationObserver(function(t){for(const e of t)"childList"===e.type?(console.log("A child node has been added or removed."),n("dd"),location.reload()):"attributes"===e.type&&(console.log("The "+e.attributeName+" attribute was modified."),n("dd"),location.reload())});if(c=document.querySelectorAll("form[action^=\"/cart\"] [type=\"submit\"]"),c=796===shopifyThemeId?c[0]:766===shopifyThemeId?c[0]:c[1],s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"number\"]"),0===s.length&&(s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"text\"]")),""!==user.individualProductLocation.tagName)if(0!==user.individualProductLocation.attribute.length&&0!==user.individualProductLocation.className.length){let t=i(user.individualProductLocation.attribute),e=o(user.individualProductLocation.className);r=document.querySelectorAll(`${user.individualProductLocation.tagName}${t}${e}`)}else if(0===user.individualProductLocation.attribute.length){let t=o(user.individualProductLocation.className);r=document.querySelectorAll(`${user.individualProductLocation.tagName}${t}`)}else if(0===user.individualProductLocation.className.length){let t=i(user.individualProductLocation.attribute);r=document.querySelectorAll(`${user.individualProductLocation.tagName}${t}`)}if(""!==user.productTotalLocation.tagName)if(0!==user.productTotalLocation.attribute.length&&0!==user.productTotalLocation.className.length){let t=i(user.productTotalLocation.attribute),e=o(user.productTotalLocation.className);u=document.querySelectorAll(`${user.productTotalLocation.tagName}${t}${e}`)}else if(0===user.productTotalLocation.attribute.length){let t=o(user.productTotalLocation.className);u=document.querySelectorAll(`${user.productTotalLocation.tagName}${t}`)}else if(0===user.productTotalLocation.className.length){let t=i(user.productTotalLocation.attribute);u=document.querySelectorAll(`${user.productTotalLocation.tagName}${t}`)}if(r.length>d.items.length){console.log(r);let t=Array.prototype.slice.call(r,0);0!=t.length%2&&t.pop(),console.log(t),r=[],u=[];for(let e=0;e<t.length;e++)0==e%2?r.push(t[e]):u.push(t[e])}console.log("individual"+r),console.log("total"+u);let b=Array.prototype.slice.call(s,0);if(console.log(shopifyThemeId),796===shopifyThemeId)for(let t=-1;t<b.length-1;t++)b.splice(t+1,1);console.log(b);for(let e=0;e<b.length;e++){var L=b[e].id.split("_");let t=L[L.length-1].split(":")[0],a=d.items[e].title,i=d.items[e].image,o="not-found";0!==r.length&&(o=r[e]);let l="not-found";0!==u.length&&(l=u[e]);let n={productName:a,productId:t,productImage:i,originalProductQuantity:d.items[e].quantity+"",price:d.items[e].price/100+"",priceDiv:o,totalPrice:d.items[e].price/100*d.items[e].quantity+"",totalPriceDiv:l,inputDiv:b[e]};g.push(n)}let p=document.createElement("button");p.type="button",p.innerText="Checkout",n("span"),fetch(`${hostedUrl}/api/test`).then(t=>t.json()).then(t=>{console.log(t.success),t.success&&(console.log("running"),console.log(c),console.log(g),c.onclick=t=>{t.preventDefault();let e=async function(){let t=await fetch("/cart.js");return t=await t.json(),t}();e.then(t=>{t.shopDomain=shopDomain,console.log(t),fetch(`${hostedUrl}/custom-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({response:t})}).then(t=>t.json()).then(t=>{console.log("Success:",t),window.location=t.url})}),console.log("clicked")})}).catch(t=>{console.log(t)})})}function a(){function t(t){t.shiftKey&&!e?(document.body.classList.add("shift-pressed"),a.style.display="none"):document.body.classList.remove("shift-pressed")}var e=!1;let a=document.createElement("div");a.style.width="fit-content",a.style.padding="1em",a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.top="3%",a.style.zIndex="99999",a.style.background="#f4f6f8",a.style.border="1px solid #bec0c2",a.style.borderRadius="4px";let i=document.createElement("p");i.innerText="Select cart subtotal amount while holding the Shift key.";let o=document.createElement("img");o.src="https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/subtotalImg.png",o.style.width="29em";let l=document.createElement("div");l.style.textAlign="right";let n=document.createElement("button");n.innerText="Save",n.style.marginLeft="0.7em",n.style.background="#bac0e6",n.style.color="white",n.style.border="1px solid grey",n.style.borderRadius="4px",n.disabled=!0;let d=document.createElement("button");d.innerText="Clear",d.style.border="1px solid grey",d.style.borderRadius="4px",l.appendChild(d),l.appendChild(n),a.appendChild(i),a.appendChild(o),a.appendChild(l),document.querySelector("body").appendChild(a);var c=document.querySelector("button");c.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("keyup",t),window.addEventListener("click",function(t){t.shiftKey&&(a.style.display="block",n.disabled=!1,n.style.background="#9c6ade",e=!0,t.target.classList.add("clicked"),n.addEventListener("click",()=>{let e=[],a=[];if(console.log(t.target.attributes),0<t.target.attributes.length)for(let i=0;i<t.target.attributes.length;i++)if("class"===t.target.attributes[i].name){e=t.target.attributes[i].value.split(" ");for(let t=0;t<e.length;t++)"clicked"===e[t]&&e.splice(t)}else a.push(t.target.attributes[i].name);console.log(e,a),axios.post(`${hostedUrl}/subtotalSave`,{className:e,tagName:t.target.tagName.toLowerCase(),shopName:shopDomain,attributes:a}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),d.addEventListener("click",()=>{n.style.background="#bac0e6",n.disabled=!0,t.target.classList.remove("clicked"),e=!1,document.body.className=""}))})}function i(){function t(t){t.shiftKey&&!e?(document.body.classList.add("shift-pressed"),a.style.display="none"):document.body.classList.remove("shift-pressed")}var e=!1;let a=document.createElement("div");a.style.width="fit-content",a.style.padding="1em",a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.top="3%",a.style.zIndex="99999",a.style.background="#f4f6f8",a.style.border="1px solid #bec0c2",a.style.borderRadius="4px";let i=document.createElement("p");i.innerText="Select product total amount while holding the Shift key.";let o=document.createElement("img");o.src="https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/totalImg.png",o.style.width="29em";let l=document.createElement("div");l.style.textAlign="right";let n=document.createElement("button");n.innerText="Save",n.style.marginLeft="0.7em",n.style.background="#bac0e6",n.style.color="white",n.style.border="1px solid grey",n.style.borderRadius="4px",n.disabled=!0;let d=document.createElement("button");d.innerText="Clear",d.style.border="1px solid grey",d.style.borderRadius="4px",l.appendChild(d),l.appendChild(n),a.appendChild(i),a.appendChild(o),a.appendChild(l),document.querySelector("body").appendChild(a);var c=document.querySelector("button");c.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("keyup",t),window.addEventListener("click",function(t){t.shiftKey&&(a.style.display="block",n.disabled=!1,n.style.background="#9c6ade",e=!0,t.target.classList.add("clicked"),n.addEventListener("click",()=>{let e=[],a=[];if(console.log(t.target.attributes),0<t.target.attributes.length)for(let i=0;i<t.target.attributes.length;i++)if("class"===t.target.attributes[i].name){e=t.target.attributes[i].value.split(" ");for(let t=0;t<e.length;t++)"clicked"===e[t]&&e.splice(t)}else a.push(t.target.attributes[i].name);console.log(e,a),axios.post(`${hostedUrl}/totalSave`,{className:e,tagName:t.target.tagName.toLowerCase(),shopName:shopDomain,attributes:a}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),d.addEventListener("click",()=>{n.style.background="#bac0e6",n.disabled=!0,t.target.classList.remove("clicked"),e=!1,document.body.className=""}))})}function o(){function t(t){t.shiftKey&&!e?(document.body.classList.add("shift-pressed"),a.style.display="none"):document.body.classList.remove("shift-pressed")}var e=!1;let a=document.createElement("div");a.style.width="fit-content",a.style.padding="1em",a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.top="3%",a.style.zIndex="99999",a.style.background="#f4f6f8",a.style.border="1px solid #bec0c2",a.style.borderRadius="4px";let i=document.createElement("p");i.innerText="Select individual product price while holding the Shift key.";let o=document.createElement("img");o.src="https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/priceImg.png",o.style.width="29em";let l=document.createElement("div");l.style.textAlign="right";let n=document.createElement("button");n.innerText="Save",n.style.marginLeft="0.7em",n.style.background="#bac0e6",n.style.color="white",n.style.border="1px solid grey",n.style.borderRadius="4px",n.disabled=!0;let d=document.createElement("button");d.innerText="Clear",d.style.border="1px solid grey",d.style.borderRadius="4px",l.appendChild(d),l.appendChild(n),a.appendChild(i),a.appendChild(o),a.appendChild(l),document.querySelector("body").appendChild(a);var c=document.querySelector("button");c.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("keyup",t),window.addEventListener("click",function(t){t.shiftKey&&(a.style.display="block",n.disabled=!1,n.style.background="#9c6ade",e=!0,t.target.classList.add("clicked"),n.addEventListener("click",()=>{let e=[],a=[];if(console.log(t.target.attributes),0<t.target.attributes.length)for(let i=0;i<t.target.attributes.length;i++)if("class"===t.target.attributes[i].name){e=t.target.attributes[i].value.split(" ");for(let t=0;t<e.length;t++)"clicked"===e[t]&&e.splice(t)}else a.push(t.target.attributes[i].name);console.log(e,a),axios.post(`${hostedUrl}/individualSave`,{className:e,tagName:t.target.tagName.toLowerCase(),shopName:shopDomain,attributes:a}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),d.addEventListener("click",()=>{n.style.background="#bac0e6",n.disabled=!0,t.target.classList.remove("clicked"),e=!1,document.body.className=""}))})}function l(){function t(t){t.shiftKey&&!e?(document.body.classList.add("shift-pressed"),a.style.display="none"):document.body.classList.remove("shift-pressed")}var e=!1;let a=document.createElement("div");a.style.width="fit-content",a.style.padding="1em",a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.top="3%",a.style.zIndex="99999",a.style.background="#f4f6f8",a.style.border="1px solid #bec0c2",a.style.borderRadius="4px";let i=document.createElement("p");i.innerText="Select individual product price while holding the Shift key.";let o=document.createElement("img");o.src="https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/priceImg.png",o.style.width="29em";let l=document.createElement("div");l.style.textAlign="right";let n=document.createElement("button");n.innerText="Save",n.style.marginLeft="0.7em",n.style.background="#bac0e6",n.style.color="white",n.style.border="1px solid grey",n.style.borderRadius="4px",n.disabled=!0;let d=document.createElement("button");d.innerText="Clear",d.style.border="1px solid grey",d.style.borderRadius="4px",l.appendChild(d),l.appendChild(n),a.appendChild(i),a.appendChild(o),a.appendChild(l),document.querySelector("body").appendChild(a);var c=document.querySelector("button");c.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("keyup",t),window.addEventListener("click",function(t){t.shiftKey&&(a.style.display="block",n.disabled=!1,n.style.background="#9c6ade",e=!0,t.target.classList.add("clicked"),n.addEventListener("click",()=>{let e=[],a=[];if(console.log(t.target.attributes),0<t.target.attributes.length)for(let i=0;i<t.target.attributes.length;i++)if("class"===t.target.attributes[i].name){e=t.target.attributes[i].value.split(" ");for(let t=0;t<e.length;t++)"clicked"===e[t]&&e.splice(t)}else a.push(t.target.attributes[i].name);console.log(e,a),axios.post(`${hostedUrl}/ajaxIndividual`,{className:e,tagName:t.target.tagName.toLowerCase(),shopName:shopDomain,attributes:a}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),d.addEventListener("click",()=>{n.style.background="#bac0e6",n.disabled=!0,t.target.classList.remove("clicked"),e=!1,document.body.className=""}))})}function n(){function t(t){t.shiftKey&&!e?(document.body.classList.add("shift-pressed"),a.style.display="none"):document.body.classList.remove("shift-pressed")}var e=!1;let a=document.createElement("div");a.style.width="fit-content",a.style.padding="1em",a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.top="3%",a.style.zIndex="99999",a.style.background="#f4f6f8",a.style.border="1px solid #bec0c2",a.style.borderRadius="4px";let i=document.createElement("p");i.innerText="Select product total amount while holding the Shift key.";let o=document.createElement("img");o.src="https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/totalImg.png",o.style.width="29em";let l=document.createElement("div");l.style.textAlign="right";let n=document.createElement("button");n.innerText="Save",n.style.marginLeft="0.7em",n.style.background="#bac0e6",n.style.color="white",n.style.border="1px solid grey",n.style.borderRadius="4px",n.disabled=!0;let d=document.createElement("button");d.innerText="Clear",d.style.border="1px solid grey",d.style.borderRadius="4px",l.appendChild(d),l.appendChild(n),a.appendChild(i),a.appendChild(o),a.appendChild(l),document.querySelector("body").appendChild(a);var c=document.querySelector("button");c.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("keyup",t),window.addEventListener("click",function(t){t.shiftKey&&(a.style.display="block",n.disabled=!1,n.style.background="#9c6ade",e=!0,t.target.classList.add("clicked"),n.addEventListener("click",()=>{let e=[],a=[];if(console.log(t.target.attributes),0<t.target.attributes.length)for(let i=0;i<t.target.attributes.length;i++)if("class"===t.target.attributes[i].name){e=t.target.attributes[i].value.split(" ");for(let t=0;t<e.length;t++)"clicked"===e[t]&&e.splice(t)}else a.push(t.target.attributes[i].name);console.log(e,a),axios.post(`${hostedUrl}/ajaxTotal`,{className:e,tagName:t.target.tagName.toLowerCase(),shopName:shopDomain,attributes:a}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),d.addEventListener("click",()=>{n.style.background="#bac0e6",n.disabled=!0,t.target.classList.remove("clicked"),e=!1,document.body.className=""}))})}function d(){function t(t){t.shiftKey&&!e?(document.body.classList.add("shift-pressed"),a.style.display="none"):document.body.classList.remove("shift-pressed")}var e=!1;let a=document.createElement("div");a.style.width="fit-content",a.style.padding="1em",a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.top="3%",a.style.zIndex="99999",a.style.background="#f4f6f8",a.style.border="1px solid #bec0c2",a.style.borderRadius="4px";let i=document.createElement("p");i.innerText="Select cart subtotal amount while holding the Shift key.";let o=document.createElement("img");o.src="https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/subtotalImg.png",o.style.width="29em";let l=document.createElement("div");l.style.textAlign="right";let n=document.createElement("button");n.innerText="Save",n.style.marginLeft="0.7em",n.style.background="#bac0e6",n.style.color="white",n.style.border="1px solid grey",n.style.borderRadius="4px",n.disabled=!0;let d=document.createElement("button");d.innerText="Clear",d.style.border="1px solid grey",d.style.borderRadius="4px",l.appendChild(d),l.appendChild(n),a.appendChild(i),a.appendChild(o),a.appendChild(l),document.querySelector("body").appendChild(a);var c=document.querySelector("button");c.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("keyup",t),window.addEventListener("click",function(t){t.shiftKey&&(a.style.display="block",n.disabled=!1,n.style.background="#9c6ade",e=!0,t.target.classList.add("clicked"),n.addEventListener("click",()=>{let e=[],a=[];if(console.log(t.target.attributes),0<t.target.attributes.length)for(let i=0;i<t.target.attributes.length;i++)if("class"===t.target.attributes[i].name){e=t.target.attributes[i].value.split(" ");for(let t=0;t<e.length;t++)"clicked"===e[t]&&e.splice(t)}else a.push(t.target.attributes[i].name);console.log(e,a),axios.post(`${hostedUrl}/ajaxSubtotal`,{className:e,tagName:t.target.tagName.toLowerCase(),shopName:shopDomain,attributes:a}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),d.addEventListener("click",()=>{n.style.background="#bac0e6",n.disabled=!0,t.target.classList.remove("clicked"),e=!1,document.body.className=""}))})}function c(){function t(t){t.shiftKey&&!e?(document.body.classList.add("shift-pressed"),a.style.display="none"):document.body.classList.remove("shift-pressed")}var e=!1;let a=document.createElement("div");a.style.width="fit-content",a.style.padding="1em",a.style.position="absolute",a.style.left="0",a.style.right="0",a.style.marginLeft="auto",a.style.marginRight="auto",a.style.top="3%",a.style.zIndex="99999",a.style.background="#f4f6f8",a.style.border="1px solid #bec0c2",a.style.borderRadius="4px";let i=document.createElement("p");i.innerText="Select Check Out button while holding the Shift key.";let o=document.createElement("img");o.src="https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/select_checkout_button.jpeg",o.style.width="29em";let l=document.createElement("div");l.style.textAlign="right";let n=document.createElement("button");n.innerText="Save",n.style.marginLeft="0.7em",n.style.background="#bac0e6",n.style.color="white",n.style.border="1px solid grey",n.style.borderRadius="4px",n.disabled=!0;let d=document.createElement("button");d.innerText="Clear",d.style.border="1px solid grey",d.style.borderRadius="4px",l.appendChild(d),l.appendChild(n),a.appendChild(i),a.appendChild(o),a.appendChild(l),document.querySelector("body").appendChild(a);var c=document.querySelector("button");c.addEventListener("mousemove",t),window.addEventListener("keydown",t),window.addEventListener("keyup",t),window.addEventListener("click",function(t){t.preventDefault(),t.shiftKey&&(a.style.display="block",n.disabled=!1,n.style.background="#9c6ade",e=!0,t.target.classList.add("clicked"),n.addEventListener("click",()=>{let e=[],a=[];if(console.log(t.target.attributes),0<t.target.attributes.length)for(let i=0;i<t.target.attributes.length;i++)if("class"===t.target.attributes[i].name){e=t.target.attributes[i].value.split(" ");for(let t=0;t<e.length;t++)"clicked"===e[t]&&e.splice(t)}else a.push(t.target.attributes[i].name);console.log(e,a),axios.post(`${hostedUrl}/ajaxCheckout`,{className:e,tagName:t.target.tagName.toLowerCase(),shopName:shopDomain,attributes:a}).then(t=>{console.log(t),window.location=frontendUrl+"/tieredPricing/settings"}).catch(t=>console.log(t))}),d.addEventListener("click",()=>{n.style.background="#bac0e6",n.disabled=!0,t.target.classList.remove("clicked"),e=!1,document.body.className=""}))})}function s(){function t(t){user.discount.forEach(e=>{for(let a=0;a<e.productIds.length;a++)e.productIds[a]===t.id&&(g=t.price,0<e.priceRule.length&&e.priceRule.forEach(t=>u.push(t)),0<e.buyXgetY.length&&e.buyXgetY.forEach(t=>p.push(t)))})}function e(t,e,a,i){let o=Math.round(t*e-a*t);"%"===i&&(o=Math.round(t*e-a/100*e*t)),console.log(shopifyCurrency);let l=Math.round(100*((t*e-o)/(t*e)));"%"===i&&(l=a);let n;if("BuyQforE"===user.tierDescription.templateType)n=`<div style="padding-bottom: 1em">
                    <p style="color: ${user.discountStyle[0].PricetextColor||"#006e5a"}; font-size: 0.8em; font-weight: 600">
                      Buy ${t+""} for  <span style="color: #babfc5; font-size: small"
                        ><del>${shopifyCurrency}.${e+""}</del></span
                      >${shopifyCurrency}.${e-a+""} each <span style="
                        color: ${user.discountStyle[0].PricetextColor2||"#f17157"};
                        font-size: medium;
                        font-weight: 600;
                      ">(${l+""}% off!)</span>
                    </p>
                    
                  </div>`;else if("BuyQforT"===user.tierDescription.templateType)n=`<div style="padding-bottom: 1em">
                    <p style="color: ${user.discountStyle[0].PricetextColor||"#006e5a"}; font-size: 0.8em; font-weight: 600">
                      Buy ${t+""} for  <span style="color: #babfc5; font-size: small"
                        ><del>${shopifyCurrency}.${t*e+""}</del></span
                      >${shopifyCurrency}.${o+""} <span style="
                        color: ${user.discountStyle[0].PricetextColor2||"#f17157"};
                        font-size: medium;
                        font-weight: 600;
                      ">(${l+""}% off!)</span>
                    </p>
                    
                  </div>`;else if("custom"===user.tierDescription.templateType){let i=h.split(" "),d=i.indexOf("[Q]"),c=i.indexOf("[E]"),s=i.indexOf("[T]"),r=i.indexOf("[D]%");console.log(d,c,s,r),-1!==d&&i.splice(d,1,`${t+""}`),-1!==c&&i.splice(c,1,`${shopifyCurrency}${e-a+""}`),-1!==s&&i.splice(s,1,`${shopifyCurrency}${o+""}`),-1!==r&&i.splice(r,1,`${l+""}%`),console.log(i.join(" ")),n=`<div style="padding-bottom: 1em">
                    <p style="color: ${user.discountStyle[0].PricetextColor||"#006e5a"}; font-size: 0.8em; font-weight: 600">
                      ${i.join(" ")}
                    </p>
                    
                  </div>`}y.push(n)}function a(t,e,a,i){let o=Math.round(t*e-a*t);"%"===i&&(o=Math.round(t*e-a/100*e*t));let l=Math.round(100*((t*e-o)/(t*e)));"%"===i&&(l=a);let n;if("BuyQforE"===user.tierDescription.templateType)n=`<p style="font-weight:700;color:${user.discountStyle[0].PricetextColor||"black"}">
                  Buy ${t+""} for ${shopifyCurrency}. ${e-a+""} each (${l+""}% off! )
                      </p>`;else if("BuyQforT"===user.tierDescription.templateType)n=`<p style="font-weight:700;color:${user.discountStyle[0].PricetextColor||"black"}">
                  Buy ${t+""} for ${shopifyCurrency}. ${o+""} (${l+""}% off! )
                      </p>`;else if("custom"===user.tierDescription.templateType){let i=h.split(" "),d=i.indexOf("[Q]"),c=i.indexOf("[E]"),s=i.indexOf("[T]"),r=i.indexOf("[D]%");console.log(d,c,s,r),-1!==d&&i.splice(d,1,`${t+""}`),-1!==c&&i.splice(c,1,`${shopifyCurrency}${e-a+""}`),-1!==s&&i.splice(s,1,`${shopifyCurrency}${o+""}`),-1!==r&&i.splice(r,1,`${l+""}%`),console.log(i.join(" ")),n=`<p style="font-weight:700;color:${user.discountStyle[0].PricetextColor||"black"}">
                 ${i.join(" ")}
                      </p>`}y.push(n)}function i(t,e,a,i){let o=Math.round(t*e-a*t);"%"===i&&(o=Math.round(t*e-a/100*e*t));let l=Math.round(100*((t*e-o)/(t*e)));"%"===i&&(l=a),console.log(o);let n;if("BuyQforE"===user.tierDescription.templateType)n=`
      <p style="color: ${user.discountStyle[0].PricetextColor||"#7f818c"}; font-weight: 400; font-size: ${user.discountStyle[0].PricetextSize+""||"18"}px">
    Buy ${t+""} for <del style="color:${user.discountStyle[0].PricetextColor||"#7f818c"}; font-weight: 400; font-size: 1em"
      >${shopifyCurrency}. ${e+""}</del
    >${shopifyCurrency}. ${e-a+""} each <span
      style="
        color:${user.discountStyle[0].PricetextColor2||"#ff915a"};
        font-weight: 600;
        font-size: ${user.discountStyle[0].PricetextSize2+""||"18"}px;
        padding-left: 0.5em;
      "
      >(${l+""}% OFF)</span
    >
  </p>`;else if("BuyQforT"===user.tierDescription.templateType)n=`
      <p style="color: ${user.discountStyle[0].PricetextColor||"#7f818c"}; font-weight: 400; font-size: ${user.discountStyle[0].PricetextSize+""||"18"}px">
    Buy ${t+""} for <del style="color:${user.discountStyle[0].PricetextColor||"#7f818c"}; font-weight: 400; font-size: 1em"
      >${shopifyCurrency}. ${t*e+""}</del
    >${shopifyCurrency}. ${o+""} <span
      style="
        color:${user.discountStyle[0].PricetextColor2||"#ff915a"};
        font-weight: 600;
        font-size: ${user.discountStyle[0].PricetextSize2+""||"18"}px;
        padding-left: 0.5em;
      "
      >(${l+""}% OFF)</span
    >
  </p>`;else if("custom"===user.tierDescription.templateType){let i=h.split(" "),d=i.indexOf("[Q]"),c=i.indexOf("[E]"),s=i.indexOf("[T]"),r=i.indexOf("[D]%");console.log(d,c,s,r),-1!==d&&i.splice(d,1,`${t+""}`),-1!==c&&i.splice(c,1,`${shopifyCurrency}${e-a+""}`),-1!==s&&i.splice(s,1,`${shopifyCurrency}${o+""}`),-1!==r&&i.splice(r,1,`${l+""}%`),console.log(i.join(" ")),n=`<p style="color: ${user.discountStyle[0].PricetextColor||"#7f818c"}; font-weight: 400; font-size: ${user.discountStyle[0].PricetextSize+""||"18"}px">
                 ${i.join(" ")}
                      </p>`}y.push(n)}function o(t,e,a,o){if("100"===o)for(let o,l=0;l<e.length;l++)o=`<div style="padding-bottom: 1em">
        <p style="color: ${user.discountStyle[0].PricetextColor||"#006e5a"}; font-size: 0.8em; font-weight: 600">
          Buy ${t+""} and get ${e[l]+""} ${a[l]} <span style="color: ${user.discountStyle[0].PricetextColor2||"#f17157"};">free</span>
        </p>
      </div>`,y.push(o);else for(let l,n=0;n<e.length;n++)l=`<div style="padding-bottom: 1em">
        <p style="color: ${user.discountStyle[0].PricetextColor||"#006e5a"}; font-size: 0.8em; font-weight: 600">
          Buy ${t+""} and get <span style="color: ${user.discountStyle[0].PricetextColor2||"#f17157"};">${o}%</span>  discount on ${e[n]} ${a[n]}
        </p>
      </div>`,y.push(l)}function l(t,e,a,o){if("100"===o)for(let o,l=0;l<e.length;l++)o=`<p style="font-weight:700;color:${user.discountStyle[0].PricetextColor||"black"}">
                    Buy ${t+""} and get ${e[l]} ${a[l]} free 
                        </p>`,y.push(o);else for(let l,n=0;n<e.length;n++)l=`<p style="font-weight:700;color:${user.discountStyle[0].PricetextColor||"black"}">
                    Buy ${t+""} and get ${o}% discount on ${e[n]} ${a[n]}
                        </p>`,y.push(l)}function n(t,e,a,o){if("100"===o)for(let o,l=0;l<e.length;l++)o=`<p style="color: ${user.discountStyle[0].PricetextColor||"#7f818c"}; font-weight: 400; font-size: ${user.discountStyle[0].PricetextSize+""||"18"}px">
    Buy ${t+""} and get ${e[l]} ${a[l]} <span
      style="
        color: ${user.discountStyle[0].PricetextColor2||"#ff915a"};
        font-weight: 600;
        font-size: ${user.discountStyle[0].PricetextSize2+""||"18"}px;
        padding-left: 0.5em;
      "
      >free</span>
    `,y.push(o);else for(let l,n=0;n<e.length;n++)l=`<p style="color: ${user.discountStyle[0].PricetextColor||"#7f818c"}; font-weight: 400; font-size:  ${user.discountStyle[0].PricetextSize+""||"18"}px">
    Buy ${t+""} and get <span
      style="
        color:${user.discountStyle[0].PricetextColor2||"#ff915a"};
        font-weight: 600;
        font-size: ${user.discountStyle[0].PricetextSize2+""||"18"}px;
        padding-left: 0.5em;
      "
      >(${o}% OFF)</span> discount on ${e[n]} ${a[n]}
    `,y.push(l)}let d;""!==user.widgetLocation.div.tagName&&(0!==user.widgetLocation.div.attribute.length&&0!==user.widgetLocation.div.className.length?d=document.querySelector(`${user.widgetLocation.div.tagName}[${user.widgetLocation.div.attribute[0]}].${user.widgetLocation.div.className[0]}`):0===user.widgetLocation.div.attribute.length?d=document.querySelector(`${user.widgetLocation.div.tagName}.${user.widgetLocation.div.className[0]}`):0===user.widgetLocation.div.className.length&&(d=document.querySelector(`${user.widgetLocation.div.tagName}[${user.widgetLocation.div.attribute[0]}]`))),console.log(d),console.log(meta);let c=[],s=[],r=[];meta.product.variants.forEach(t=>{let e={id:t.id,price:Math.round(t.price/100)};r.push(e),c.push(t.id),s.push(Math.round(t.price/100))}),console.log(r),console.log(c);let u=[],p=[],g=0;t(r[0]),console.log(u),console.log(p);let y=[];console.log(g),console.log(user.tierDescription.templateType);let h="";"custom"===user.tierDescription.templateType&&(h=user.tierDescription.customText);let m=parseInt(user.widgetNumber);console.log(typeof m),console.log(0<u.length),0<u.length&&u.forEach(t=>{switch(m){case 1:e(t.quantity,g,t.discount,t.discountType);break;case 2:a(t.quantity,g,t.discount,t.discountType);break;case 3:i(t.quantity,g,t.discount,t.discountType);break;default:}}),0<p.length&&p.forEach(t=>{let e=[],a=[];switch(console.log(t.yProduct),t.yProduct.forEach(t=>{e.push(t.title),a.push(parseInt(t.quantity))}),m){case 1:o(t.quantity,a,e,t.yDiscountValue);break;case 2:l(t.quantity,a,e,t.yDiscountValue);break;case 3:n(t.quantity,a,e,t.yDiscountValue);break;default:}}),console.log(y.join(" "));let b;switch(m){case 1:b=`
        <div
  style="
    padding: 2em 0.1em 1em;
    border: ${user.discountStyle[0].PriceborderWidth+""}px ${user.discountStyle[0].PriceborderStyle} ${user.discountStyle[0].PriceborderColor};
    text-align: center;
    width: fit-content;
    border-radius: ${user.discountStyle[0].PriceborderRadius+""}px;
    position: relative;
    margin-top:1em;
    margin-bottom: 1em;
    background-color:${user.discountStyle[0].PricebackGroundColor}
  "
  id="Variant 1"
>
  <span
    style="
      background-color: ${user.discountStyle[0].backGroundColor||"#006e5a"};
      color: ${user.discountStyle[0].textColor||"white"};
      font-size: small;
      padding: 0.7em;
      position: absolute;
      top: -2em;
      left: 26%;
      border: ${user.discountStyle[0].borderWidth+""||"4"}px ${user.discountStyle[0].borderStyle||"solid"} #fff;
      border-radius: ${user.discountStyle[0].borderRadius+""||"10"}px;
      font-weight: 500;
    "
    >${user.discountStyle[0].tierMessage}</span
  >
  ${y.join(" ")}
  <p style="color:grey;font-size:small">(Kindly add the items in cart for applicable discount)</p>
  
</div>
`;break;case 2:b=`
        <div
  style="
    width: fit-content;
    
    margin-top: 1em;
  "
>
  <div
    style="padding: 1em 1em; text-align: left; border: ${user.discountStyle[0].borderWidth+""||"1"}px ${user.discountStyle[0].borderStyle||"solid"}
   ${user.discountStyle[0].borderColor||"white"};background-color: ${user.discountStyle[0].backGroundColor||"#f1f2f2"};color:${user.discountStyle[0].textColor};border-radius:${user.discountStyle[0].borderRadius+""||"0"}px"
  >
    <p style="font-weight: 700;color:${user.discountStyle[0].textColor||"white"}">${user.discountStyle[0].tierMessage}:</p>
  </div>
  <div style="padding: 1em 1em; text-align: center;border: ${user.discountStyle[0].PriceborderWidth+""||"1"}px ${user.discountStyle[0].PriceborderStyle||"solid"}
   ${user.discountStyle[0].PriceborderColor||"#707e8c"};background-color: ${user.discountStyle[0].PricebackGroundColor||"#f1f2f2"};border-radius:${user.discountStyle[0].PriceborderRadius+""||"0"}px">
    ${y.join(" ")}
      <p style="color:grey;font-size:small">(Kindly add the items in cart for applicable discount or free)</p>
  </div>
</div>
`;break;case 3:b=`
        <div id="Variant 3" style="margin-top: 1em">
        Offers: 
  ${y.join(" ")}
    <p style="color:grey;font-size:small">(Kindly add the items in cart for applicable discount or free)</p>
</div>
`;break;default:}console.log(b),(0<u.length||0<p.length)&&("Below"===user.widgetLocation.location?d.insertAdjacentHTML("afterend",b):"Above"===user.widgetLocation.location&&d.insertAdjacentHTML("beforebegin",b))}function r(t){let e=async function(){let t=await fetch("/cart.js");return t=await t.json(),t}();e.then(e=>{let a=e;console.log(a);let i=document.querySelector("a[href=\"/cart\"]");i.addEventListener("click",()=>{setTimeout(()=>{function e(t,e){let a={applicableDiscount:0,discountType:""};return discounts.forEach(o=>{if(o.enable&&-1!==o.productIds.indexOf(e))for(let e=0;e<o.priceRule.length;e++)o.priceRule[e].quantity===t&&(a.applicableDiscount=o.priceRule[e].discount,a.discountType=o.priceRule[e].discountType)}),a}function i(t,e){let o={applicableDiscount:0,XproductId:0,XproductName:"",YproductId:[],YproductName:[]};return discounts.forEach(l=>{if(l.enable&&-1!==l.productIds.indexOf(e))for(let n=0;n<l.buyXgetY.length;n++)l.buyXgetY[n].quantity===t&&(o.applicableDiscount=l.buyXgetY[n].yDiscountValue,o.XproductId=e,l.buyXgetY[n].yProduct.forEach(t=>{o.YproductId.push(t.id),o.YproductName.push(t.title)}),a.items.forEach(t=>{if(t.variant_id===e)return void(o.XproductName=t.title)}))}),o}function o(t){let e=[];for(let a=0;a<t.length;a++)e.push(`[${t[a]}]`);return e.join("")}function l(t){let e=[];for(let a=0;a<t.length;a++)e.push(`.${t[a]}`);return e.join("")}function n(t,e){return`You are eligible for a discount of ${t}% off on ${e}`}function d(){if(""!==user.ajaxLocations.checkoutButton_Ajax_Location.tagName){function d(t){var e=t.target.id.split("_");let a=e[e.length-1].split(":")[0];for(let e=0;e<g.length;e++)g[e].productId===a&&(g[e].originalProductQuantity=t.target.value);console.log(g),m.observe(y,h)}let b=l(user.ajaxLocations.checkoutButton_Ajax_Location.className);if(c=document.querySelector(`${user.ajaxLocations.checkoutButton_Ajax_Location.tagName}${b}[type="submit"]`),"products"===t&&679===shopifyThemeId&&(c=document.querySelectorAll(`${user.ajaxLocations.checkoutButton_Ajax_Location.tagName}${b}[type="submit"]`),c=c[1]),s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"number\"]"),0===s.length&&(s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"text\"]")),""!==user.ajaxLocations.individualProduct_Ajax_Location.tagName)if(0!==user.ajaxLocations.individualProduct_Ajax_Location.attribute.length&&0!==user.ajaxLocations.individualProduct_Ajax_Location.className.length){let t=o(user.ajaxLocations.individualProduct_Ajax_Location.attribute),e=l(user.ajaxLocations.individualProduct_Ajax_Location.className);console.log(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}${e}`),r=document.querySelectorAll(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}${e}`)}else if(0===user.ajaxLocations.individualProduct_Ajax_Location.attribute.length){let t=l(user.ajaxLocations.individualProduct_Ajax_Location.className);console.log(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`),r=document.querySelectorAll(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`)}else if(0===user.ajaxLocations.individualProduct_Ajax_Location.className.length){let t=o(user.ajaxLocations.individualProduct_Ajax_Location.attribute);console.log(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`),r=document.querySelectorAll(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`)}if(""!==user.ajaxLocations.productTotal_Ajax_Location.tagName)if(0!==user.ajaxLocations.productTotal_Ajax_Location.attribute.length&&0!==user.ajaxLocations.productTotal_Ajax_Location.className.length){let t=o(user.ajaxLocations.productTotal_Ajax_Location.attribute),e=l(user.ajaxLocations.productTotal_Ajax_Location.className);console.log(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}${e}`),u=document.querySelectorAll(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}${e}`)}else if(0===user.ajaxLocations.productTotal_Ajax_Location.attribute.length){let t=l(user.ajaxLocations.productTotal_Ajax_Location.className);console.log(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`),u=document.querySelectorAll(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`)}else if(0===user.ajaxLocations.productTotal_Ajax_Location.className.length){let t=o(user.ajaxLocations.productTotal_Ajax_Location.attribute);console.log(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`),u=document.querySelectorAll(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`)}if(r.length>a.items.length){console.log(r);let t=Array.prototype.slice.call(r,0);0!=t.length%2&&t.pop(),console.log(t),r=[],u=[];for(let e=0;e<t.length;e++)0==e%2?r.push(t[e]):u.push(t[e])}console.log("individual"+r),console.log("total"+u),m.disconnect(),console.log(g);let L=0,f=0,x=[],j=[],v=[];g.forEach(t=>{let a=parseInt(t.originalProductQuantity)*parseInt(t.price);L+=a;let o=e(parseInt(t.originalProductQuantity),parseInt(t.productId));console.log(o);let l;if("%"===o.discountType){l=o.applicableDiscount;let e=l/100*parseInt(t.price),a=parseInt(t.price)-e;x.push(a),console.log(a*parseInt(t.originalProductQuantity));let i=a*parseInt(t.originalProductQuantity);j.push(i),0!==l&&(f+=e*parseInt(t.originalProductQuantity))}else{l=o.applicableDiscount,l*=parseInt(t.originalProductQuantity),console.log(l);let e=(a-parseInt(l))/t.originalProductQuantity;x.push(e);let i=a-parseInt(l);j.push(i),"0"!==l&&(f+=l)}let n=i(parseInt(t.originalProductQuantity),parseInt(t.productId));0!==n.applicableDiscount&&v.push(n)});let S=user.Customtemplate.template;console.log(S),console.log(L,f),console.log(x),console.log(j);let _=L-f;if(console.log(_),console.log("heyy"),user.Customtemplate.showCustomTemplate&&user.Customtemplate.location.subtotalPrice){let t=Math.round(L-_)+"",e=S.search(":diff"),a=S.split("");console.log(a),a.splice(e,5,`${shopifyCurrency}.${t}`),console.log(a.join("")),y&&(_===L?y.innerHTML=`<ins style="text-decoration:none">${shopifyCurrency}. ${L+""}.00</ins>`:y.innerHTML=`<del style="font-size:0.8em;font-weight:600;color:grey">${shopifyCurrency}. ${Math.round(L)+""}.00</del><br> <ins style="text-decoration:none">${shopifyCurrency}. ${Math.round(_)+""}.00</ins><br><span style="color:#ef5e64;font-weight:600">${a.join("")}</span>`)}if(user.Customtemplate.showCustomTemplate&&user.Customtemplate.location.individualPrice)for(let t=0;t<x.length;t++){let e=parseInt(g[t].price)-Math.round(x[t])+"",a=S.search(":diff"),i=S.split("");console.log(i),i.splice(a,5,`${shopifyCurrency}.${e}`),console.log(i.join("")),g[t].priceDiv&&x[t]!==parseInt(g[t].price)&&(g[t].priceDiv.innerHTML=`<del style="font-size:0.8em;font-weight:600;color:grey">${shopifyCurrency}. ${g[t].price}.00</del> <br><ins style="text-decoration:none">${shopifyCurrency}. ${Math.round(x[t])+""}.00</ins><br><span style="color:#ef5e64;font-weight:600">${i.join("")}</span>
                `)}if(user.Customtemplate.showCustomTemplate&&user.Customtemplate.location.totalPrice)for(let t,e=0;e<j.length;e++){t=parseInt(g[e].originalProductQuantity)*parseInt(g[e].price),console.log(g[e].originalProductQuantity,g[e].price),console.log(j[e]);let a=t-Math.round(j[e])+"",i=S.search(":diff"),o=S.split("");console.log(o),o.splice(i,5,`${shopifyCurrency}.${a}`),console.log(o.join("")),g[e].totalPriceDiv&&j[e]!==t&&(g[e].totalPriceDiv.innerHTML=`<del style="font-size:0.8em;font-weight:600;color:grey">${shopifyCurrency}. ${t+""}.00</del><br> <ins style="text-decoration:none">${shopifyCurrency}. ${Math.round(j[e])+""}.00</ins><br><span style="color:#ef5e64;font-weight:600">${o.join("")}</span>`)}let T=document.createElement("div");T.style.width="fit-content",T.style.padding="1em",T.style.position="absolute",T.style.left="0",T.style.right="0",T.style.marginLeft="auto",T.style.marginRight="auto",T.style.top="3%",T.style.zIndex="99999",T.style.background="#f4f6f8",T.style.border="1px solid #bec0c2",T.style.borderRadius="4px";let N=document.createElement("p"),p=document.createElement("div");p.style.textAlign="right";let A=document.createElement("button");A.innerText="OK",A.style.background="#337CA0",A.style.padding="0.2em 1em",A.style.color="white",A.style.border="1px solid grey",A.style.borderRadius="14px",A.style.float="right",A.onclick=()=>{T.style.display="none"},p.appendChild(A),T.appendChild(N),T.appendChild(p),T.style.display="none",document.querySelector("body").appendChild(T);let k=[];console.log(v);let P=[];a.items.forEach(t=>{k.push(t.variant_id)}),console.log(k);for(let t=0;t<v.length;t++){console.log(-1===k.indexOf(v[t].XproductId)),console.log(n(v[t].applicableDiscount,v[t].YproductName));for(let e=0;e<v[t].YproductId.length;e++)-1===k.indexOf(v[t].YproductId[e])&&P.push(n(v[t].applicableDiscount,v[t].YproductName[e]))}console.log(P),0<P.length&&(N.innerText=P.join("\n")+"\nKindly add the products in cart to avail the discount.",T.style.display="block"),s.forEach(t=>{t.addEventListener("input",d)}),console.log("event listeners set")}}var c,s,r=[],u=[];let g=[];console.log(discounts),console.log(user);var y;if(""!==user.ajaxLocations.cartSubTotal_Ajax_Location.tagName)if(0!==user.ajaxLocations.cartSubTotal_Ajax_Location.attribute.length&&0!==user.ajaxLocations.cartSubTotal_Ajax_Location.className.length){let t=o(user.ajaxLocations.cartSubTotal_Ajax_Location.attribute),e=l(user.ajaxLocations.cartSubTotal_Ajax_Location.className);console.log(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}${t}${e}`),y=document.querySelector(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}${t}${e}`)}else if(0===user.ajaxLocations.cartSubTotal_Ajax_Location.attribute.length&&0===user.ajaxLocations.cartSubTotal_Ajax_Location.className.length){console.log(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}`);const t=document.querySelectorAll(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}`);let e=Array.prototype.slice.call(t,0);const a=e.find(t=>0===t.attributes.length);console.log(a),y=a}else if(0===user.ajaxLocations.cartSubTotal_Ajax_Location.attribute.length){let t=l(user.ajaxLocations.cartSubTotal_Ajax_Location.className);console.log(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}${t}`),y=document.querySelector(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}${t}`)}else if(0===user.ajaxLocations.cartSubTotal_Ajax_Location.className.length){let e=o(user.ajaxLocations.cartSubTotal_Ajax_Location.attribute);console.log(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}${e}`),y=document.querySelector(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}${e}`),"collections"===t&&679===shopifyThemeId&&(y=document.querySelectorAll(`${user.ajaxLocations.cartSubTotal_Ajax_Location.tagName}${e}`),y=y[y.length-1])}console.log(y);const h={attributes:!0,childList:!0,subtree:!0};console.log("reached");const m=new MutationObserver(function(t){for(const e of t)"childList"===e.type?(console.log("A child node has been added or removed."),d("dd"),location.reload()):"attributes"===e.type&&(console.log("The "+e.attributeName+" attribute was modified."),d("dd"),location.reload())});if(""!==user.ajaxLocations.checkoutButton_Ajax_Location.tagName){let e=l(user.ajaxLocations.checkoutButton_Ajax_Location.className);console.log(`${user.ajaxLocations.checkoutButton_Ajax_Location.tagName}${e}[type="submit"]`),c=document.querySelector(`${user.ajaxLocations.checkoutButton_Ajax_Location.tagName}${e}[type="submit"]`),"products"===t&&679===shopifyThemeId&&(c=document.querySelectorAll(`${user.ajaxLocations.checkoutButton_Ajax_Location.tagName}${e}[type="submit"]`),c=c[1])}if(s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"number\"]"),0===s.length&&(s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"text\"]")),796===shopifyThemeId&&(s=document.querySelectorAll("form[action^=\"/cart\"] [type=\"text\"]")),""!==user.ajaxLocations.individualProduct_Ajax_Location.tagName)if(0!==user.ajaxLocations.individualProduct_Ajax_Location.attribute.length&&0!==user.ajaxLocations.individualProduct_Ajax_Location.className.length){let t=o(user.ajaxLocations.individualProduct_Ajax_Location.attribute),e=l(user.ajaxLocations.individualProduct_Ajax_Location.className);console.log(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}${e}`),r=document.querySelectorAll(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}${e}`)}else if(0===user.ajaxLocations.individualProduct_Ajax_Location.attribute.length){let t=l(user.ajaxLocations.individualProduct_Ajax_Location.className);console.log(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`),r=document.querySelectorAll(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`)}else if(0===user.ajaxLocations.individualProduct_Ajax_Location.className.length){let t=o(user.ajaxLocations.individualProduct_Ajax_Location.attribute);console.log(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`),r=document.querySelectorAll(`${user.ajaxLocations.individualProduct_Ajax_Location.tagName}${t}`)}if(""!==user.ajaxLocations.productTotal_Ajax_Location.tagName)if(0!==user.ajaxLocations.productTotal_Ajax_Location.attribute.length&&0!==user.ajaxLocations.productTotal_Ajax_Location.className.length){let t=o(user.ajaxLocations.productTotal_Ajax_Location.attribute),e=l(user.ajaxLocations.productTotal_Ajax_Location.className);console.log(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}${e}`),u=document.querySelectorAll(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}${e}`)}else if(0===user.ajaxLocations.productTotal_Ajax_Location.attribute.length){let t=l(user.ajaxLocations.productTotal_Ajax_Location.className);console.log(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`),u=document.querySelectorAll(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`)}else if(0===user.ajaxLocations.productTotal_Ajax_Location.className.length){let t=o(user.ajaxLocations.productTotal_Ajax_Location.attribute);console.log(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`),u=document.querySelectorAll(`${user.ajaxLocations.productTotal_Ajax_Location.tagName}${t}`)}if(r.length>a.items.length){console.log(r);let t=Array.prototype.slice.call(r,0);0!=t.length%2&&t.pop(),console.log(t),r=[],u=[];for(let e=0;e<t.length;e++)0==e%2?r.push(t[e]):u.push(t[e])}console.log(r),console.log(u);let b=Array.prototype.slice.call(s,0);if(console.log(shopifyThemeId),796===shopifyThemeId)for(let t=-1;t<b.length-1;t++)b.splice(t+1,1);console.log(b);for(let t=0;t<b.length;t++){let e=a.items[t].id,i=a.items[t].title,o=a.items[t].image,l="not-found";0!==r.length&&(l=r[t]);let n="not-found";0!==u.length&&(n=u[t]);let d={productName:i,productId:e,productImage:o,originalProductQuantity:a.items[t].quantity+"",price:a.items[t].price/100+"",priceDiv:l,totalPrice:a.items[t].price/100*a.items[t].quantity+"",totalPriceDiv:n,inputDiv:b[t]};g.push(d)}let L=document.createElement("button");L.type="button",L.innerText="Checkout",d("span"),fetch(`${hostedUrl}/api/test`).then(t=>t.json()).then(t=>{console.log(t.success),t.success&&(console.log("running"),console.log(c),console.log(g),c.onclick=t=>{t.preventDefault();let e=async function(){let t=await fetch("/cart.js");return t=await t.json(),t}();e.then(t=>{t.shopDomain=shopDomain,console.log(t),fetch(`${hostedUrl}/custom-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({response:t})}).then(t=>t.json()).then(t=>{console.log("Success:",t),window.location=t.url})}),console.log("clicked")})}).catch(t=>{console.log(t)})},2e3)})})}console.log("inside start function"),function(){var t=document.createElement("link");t.setAttribute("rel","stylesheet"),t.setAttribute("type","text/css"),t.setAttribute("href","https://sacdnfiles.s3.ap-south-1.amazonaws.com/dicount+app/discount-rendering.css"),document.head.appendChild(t)}();let u=document.createElement("script");u.src="https://unpkg.com/axios/dist/axios.min.js",document.querySelector("body").appendChild(u);let p=window.location.href.split("/");console.log(p),console.log(user.hasAjaxCart);for(let u=0;u<p.length;u++)if("products"===p[u]){let e=p.join("/").split("?");-1===e[e.length-1].search("widgetSelector")?-1===e[e.length-1].search("ajaxIndividualSelector")?-1===e[e.length-1].search("ajaxTotalSelector")?-1===e[e.length-1].search("ajaxSubtotalSelector")?-1===e[e.length-1].search("ajaxCheckoutSelector")?(console.log("renderWidget"),s(),user.hasAjaxCart&&r("products")):(console.log("ajaxCheckoutSelector"),c()):(console.log("ajaxSubtotalSelector"),d()):(console.log("ajaxTotalSelector"),n()):(console.log("ajaxIndividualSelector"),l()):(console.log("selectWidgetLocation"),t())}else if("cart"===p[u]||"cart?subtotalSelector"===p[u]||"cart?totalSelector"===p[u]||"cart?individualPriceSelector"===p[u]){let t=p.join("/").split("?");`subtotalSelector`===t[t.length-1]?(console.log("subtotalSelector"),a()):`totalSelector`===t[t.length-1]?(console.log("totalSelector"),i()):`individualPriceSelector`===t[t.length-1]?(console.log("individualPriceSelector"),o()):(console.log("checkOut"),e())}else"collections"===p[u]&&(console.log(user.hasAjaxCart),user.hasAjaxCart&&r("collections"));""===p[p.length-1]&&user.hasAjaxCart&&r("homepage")}async function initTieredPricing(){try{let t=await fetch(`${hostedUrl}/api/userData`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:shopDomain})});if(t=await t.json(),console.log(t.data[0]),user=t.data[0],discounts=t.data[0].discount,console.log(user.Discountenable),user.Discountenable){console.log("%c%s","color: white;background:#45b3e0;font-weight:600;padding:0.3em"," \xF0\u0178\u017D\u2030Tiered Discounts by Super Assistant: ready"),console.log("now will run start function"),startTieredPricing()}else{console.log("%c%s","color: white;background:#45b3e0;font-weight:600;padding:0.3em"," \xF0\u0178\u017D\u2030Tiered Discounts by Super Assistant: disabled")}}catch(t){console.log(t),console.log("app not working")}}initTieredPricing();
